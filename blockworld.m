M = [5,1,18,-1,1;
    18,7,5,-1,1;
    18,4,11,-1,1;
    11,1,18,-1,0.9;
    11,1,3,-10,0.1;
    11,2,18,-10,0.1;
    11,2,3,-1,0.9;
    3,11,11,-1,0.9;
    3,11,15,-10,0.1;
    3,8,11,-10,0.1;
    3,8,15,-1,0.9;
    3,5,1,-1,1;
    15,2,3,-1,0.9;
    15,2,22,-10,0.1;
    15,3,22,-1,0.9;
    15,3,3,-10,0.1;
    22,6,15,-1,1;
    22,12,10,-1,1;
    10,3,22,-1,1;
    1,2,3,-1,0.8;
    1,2,4,-10,0.1;
    1,2,2,-10,0.1;
    1,1,2,-1,0.8;
    1,1,3,-10,0.1;
    1,1,4,-10,0.1;
    1,3,4,-1,0.8;
    1,3,3,-10,0.1;
    1,3,2,-10,0.1;
    4,6,1,-1,1;
    4,10,14,-1,0.9;
    4,10,12,-10,0.1;
    4,12,12,-1,0.9;
    4,12,14,-10,0.1;
    2,4,1,-1,1;
    2,9,13,-1,0.9;
    2,9,16,-10,0.1;
    2,7,13,-10,0.1;
    2,7,16,-1,0.9;
    14,3,4,-1,0.9;
    14,3,20,-10,0.1;
    14,2,20,-1,0.9;
    14,2,4,-10,0.1;
    20,5,14,-1,1;
    20,11,8,-1,1;
    12,3,4,-1,0.9;
    12,3,19,-10,0.1;
    12,1,4,-10,0.1;
    12,1,19,-1,0.9;
    19,4,12,-1,1;
    19,9,7,-1,1;
    7,1,19,-1,1;
    16,1,2,-1,0.9;
    16,1,21,-10,0.1;
    16,3,21,-1,0.9;
    16,3,2,-10,0.1;
    21,6,16,-1,1;
    21,10,9,-1,1;
    9,3,21,-1,1;
    13,1,2,-1,0.9;
    13,1,17,-10,0.1;
    13,2,2,-10,0.1;
    13,2,17,-1,0.9;
    17,5,13,-1,1;
    17,8,6,-1,1;
    6,2,17,-1,1];

count=0;
reward_M = zeros(41,3);
x = 0.0;
for i=1:65
    x = M(i,4)*M(i,5);
    y=i+1;
    for j=y:65
       if M(i,1)==M(j,1) && M(i,2)==M(j,2)
           x = x + M(j,4)*M(j,5);
       end
    end
    for z=1:41
      if (reward_M(z,1) == M(i,1) && reward_M(z,2)== M(i,2)) 
          flag = 1; 
      end
    end
    if flag ~= 1
          count = count +1;
          reward_M(count,1)= M(i,1);
          reward_M(count,2)= M(i,2);
          reward_M(count,3)= x;
    end
    x=0.0;
    flag=222;
end
p_max = zeros(22,1);
e=0.000000001;
gama = 0.9;
u = zeros(22,1);
n = zeros(41,1);
new_max = zeros(22,1);
d=10;
 while d>=e
    d=0;
    for b=1:21
        for i=1:41
            sum=0;
          for j=1:65
             if (reward_M(i,1) == M(j,1) && reward_M(i,2)== M(j,2)) 
                sum = sum + (M(j,5)*u(b));
             end
          end
          n(i) = reward_M(i,3) + gama*sum; 
        end
        for k=1:41
            for l=1:41
              if (reward_M(k,1) == reward_M(l,1) && n(k) <= n(l))
                  new_max(reward_M(l,1)) = n(l); 
                  p_max(reward_M(l,1)) = reward_M(l,2);
              end
            end
        end
            if abs(new_max(b)-u(b))>d
                 d = abs(new_max(b)-u(b));
            end
            u(b) = new_max(b);
    end
 end
 u
 p_max

